#include "tftlcd.h"



static  unsigned char ascii_1608[95][16]={	
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*" ",0*/
{0x00,0x00,0x00,0x00,0x00,0x00,0x1F,0xCC,0x00,0x0C,0x00,0x00,0x00,0x00,0x00,0x00},/*"!",1*/
{0x00,0x00,0x08,0x00,0x30,0x00,0x60,0x00,0x08,0x00,0x30,0x00,0x60,0x00,0x00,0x00},/*""",2*/
{0x02,0x20,0x03,0xFC,0x1E,0x20,0x02,0x20,0x03,0xFC,0x1E,0x20,0x02,0x20,0x00,0x00},/*"#",3*/
{0x00,0x00,0x0E,0x18,0x11,0x04,0x3F,0xFF,0x10,0x84,0x0C,0x78,0x00,0x00,0x00,0x00},/*"$",4*/
{0x0F,0x00,0x10,0x84,0x0F,0x38,0x00,0xC0,0x07,0x78,0x18,0x84,0x00,0x78,0x00,0x00},/*"%",5*/
{0x00,0x78,0x0F,0x84,0x10,0xC4,0x11,0x24,0x0E,0x98,0x00,0xE4,0x00,0x84,0x00,0x08},/*"&",6*/
{0x08,0x00,0x68,0x00,0x70,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"'",7*/
{0x00,0x00,0x00,0x00,0x00,0x00,0x07,0xE0,0x18,0x18,0x20,0x04,0x40,0x02,0x00,0x00},/*"(",8*/
{0x00,0x00,0x40,0x02,0x20,0x04,0x18,0x18,0x07,0xE0,0x00,0x00,0x00,0x00,0x00,0x00},/*")",9*/
{0x02,0x40,0x02,0x40,0x01,0x80,0x0F,0xF0,0x01,0x80,0x02,0x40,0x02,0x40,0x00,0x00},/*"*",10*/
{0x00,0x80,0x00,0x80,0x00,0x80,0x0F,0xF8,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x00},/*"+",11*/
{0x00,0x01,0x00,0x0D,0x00,0x0E,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*",",12*/
{0x00,0x00,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80},/*"-",13*/
{0x00,0x00,0x00,0x0C,0x00,0x0C,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*".",14*/
{0x00,0x00,0x00,0x06,0x00,0x18,0x00,0x60,0x01,0x80,0x06,0x00,0x18,0x00,0x20,0x00},/*"/",15*/
{0x00,0x00,0x07,0xF0,0x08,0x08,0x10,0x04,0x10,0x04,0x08,0x08,0x07,0xF0,0x00,0x00},/*"0",16*/
{0x00,0x00,0x08,0x04,0x08,0x04,0x1F,0xFC,0x00,0x04,0x00,0x04,0x00,0x00,0x00,0x00},/*"1",17*/
{0x00,0x00,0x0E,0x0C,0x10,0x14,0x10,0x24,0x10,0x44,0x11,0x84,0x0E,0x0C,0x00,0x00},/*"2",18*/
{0x00,0x00,0x0C,0x18,0x10,0x04,0x11,0x04,0x11,0x04,0x12,0x88,0x0C,0x70,0x00,0x00},/*"3",19*/
{0x00,0x00,0x00,0xE0,0x03,0x20,0x04,0x24,0x08,0x24,0x1F,0xFC,0x00,0x24,0x00,0x00},/*"4",20*/
{0x00,0x00,0x1F,0x98,0x10,0x84,0x11,0x04,0x11,0x04,0x10,0x88,0x10,0x70,0x00,0x00},/*"5",21*/
{0x00,0x00,0x07,0xF0,0x08,0x88,0x11,0x04,0x11,0x04,0x18,0x88,0x00,0x70,0x00,0x00},/*"6",22*/
{0x00,0x00,0x1C,0x00,0x10,0x00,0x10,0xFC,0x13,0x00,0x1C,0x00,0x10,0x00,0x00,0x00},/*"7",23*/
{0x00,0x00,0x0E,0x38,0x11,0x44,0x10,0x84,0x10,0x84,0x11,0x44,0x0E,0x38,0x00,0x00},/*"8",24*/
{0x00,0x00,0x07,0x00,0x08,0x8C,0x10,0x44,0x10,0x44,0x08,0x88,0x07,0xF0,0x00,0x00},/*"9",25*/
{0x00,0x00,0x00,0x00,0x00,0x00,0x03,0x0C,0x03,0x0C,0x00,0x00,0x00,0x00,0x00,0x00},/*":",26*/
{0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x06,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*";",27*/
{0x00,0x00,0x00,0x80,0x01,0x40,0x02,0x20,0x04,0x10,0x08,0x08,0x10,0x04,0x00,0x00},/*"<",28*/
{0x02,0x20,0x02,0x20,0x02,0x20,0x02,0x20,0x02,0x20,0x02,0x20,0x02,0x20,0x00,0x00},/*"=",29*/
{0x00,0x00,0x10,0x04,0x08,0x08,0x04,0x10,0x02,0x20,0x01,0x40,0x00,0x80,0x00,0x00},/*">",30*/
{0x00,0x00,0x0E,0x00,0x12,0x00,0x10,0x0C,0x10,0x6C,0x10,0x80,0x0F,0x00,0x00,0x00},/*"?",31*/
{0x03,0xE0,0x0C,0x18,0x13,0xE4,0x14,0x24,0x17,0xC4,0x08,0x28,0x07,0xD0,0x00,0x00},/*"@",32*/
{0x00,0x04,0x00,0x3C,0x03,0xC4,0x1C,0x40,0x07,0x40,0x00,0xE4,0x00,0x1C,0x00,0x04},/*"A",33*/
{0x10,0x04,0x1F,0xFC,0x11,0x04,0x11,0x04,0x11,0x04,0x0E,0x88,0x00,0x70,0x00,0x00},/*"B",34*/
{0x03,0xE0,0x0C,0x18,0x10,0x04,0x10,0x04,0x10,0x04,0x10,0x08,0x1C,0x10,0x00,0x00},/*"C",35*/
{0x10,0x04,0x1F,0xFC,0x10,0x04,0x10,0x04,0x10,0x04,0x08,0x08,0x07,0xF0,0x00,0x00},/*"D",36*/
{0x10,0x04,0x1F,0xFC,0x11,0x04,0x11,0x04,0x17,0xC4,0x10,0x04,0x08,0x18,0x00,0x00},/*"E",37*/
{0x10,0x04,0x1F,0xFC,0x11,0x04,0x11,0x00,0x17,0xC0,0x10,0x00,0x08,0x00,0x00,0x00},/*"F",38*/
{0x03,0xE0,0x0C,0x18,0x10,0x04,0x10,0x04,0x10,0x44,0x1C,0x78,0x00,0x40,0x00,0x00},/*"G",39*/
{0x10,0x04,0x1F,0xFC,0x10,0x84,0x00,0x80,0x00,0x80,0x10,0x84,0x1F,0xFC,0x10,0x04},/*"H",40*/
{0x00,0x00,0x10,0x04,0x10,0x04,0x1F,0xFC,0x10,0x04,0x10,0x04,0x00,0x00,0x00,0x00},/*"I",41*/
{0x00,0x03,0x00,0x01,0x10,0x01,0x10,0x01,0x1F,0xFE,0x10,0x00,0x10,0x00,0x00,0x00},/*"J",42*/
{0x10,0x04,0x1F,0xFC,0x11,0x04,0x03,0x80,0x14,0x64,0x18,0x1C,0x10,0x04,0x00,0x00},/*"K",43*/
{0x10,0x04,0x1F,0xFC,0x10,0x04,0x00,0x04,0x00,0x04,0x00,0x04,0x00,0x0C,0x00,0x00},/*"L",44*/
{0x10,0x04,0x1F,0xFC,0x1F,0x00,0x00,0xFC,0x1F,0x00,0x1F,0xFC,0x10,0x04,0x00,0x00},/*"M",45*/
{0x10,0x04,0x1F,0xFC,0x0C,0x04,0x03,0x00,0x00,0xE0,0x10,0x18,0x1F,0xFC,0x10,0x00},/*"N",46*/
{0x07,0xF0,0x08,0x08,0x10,0x04,0x10,0x04,0x10,0x04,0x08,0x08,0x07,0xF0,0x00,0x00},/*"O",47*/
{0x10,0x04,0x1F,0xFC,0x10,0x84,0x10,0x80,0x10,0x80,0x10,0x80,0x0F,0x00,0x00,0x00},/*"P",48*/
{0x07,0xF0,0x08,0x18,0x10,0x24,0x10,0x24,0x10,0x1C,0x08,0x0A,0x07,0xF2,0x00,0x00},/*"Q",49*/
{0x10,0x04,0x1F,0xFC,0x11,0x04,0x11,0x00,0x11,0xC0,0x11,0x30,0x0E,0x0C,0x00,0x04},/*"R",50*/
{0x00,0x00,0x0E,0x1C,0x11,0x04,0x10,0x84,0x10,0x84,0x10,0x44,0x1C,0x38,0x00,0x00},/*"S",51*/
{0x18,0x00,0x10,0x00,0x10,0x04,0x1F,0xFC,0x10,0x04,0x10,0x00,0x18,0x00,0x00,0x00},/*"T",52*/
{0x10,0x00,0x1F,0xF8,0x10,0x04,0x00,0x04,0x00,0x04,0x10,0x04,0x1F,0xF8,0x10,0x00},/*"U",53*/
{0x10,0x00,0x1E,0x00,0x11,0xE0,0x00,0x1C,0x00,0x70,0x13,0x80,0x1C,0x00,0x10,0x00},/*"V",54*/
{0x1F,0xC0,0x10,0x3C,0x00,0xE0,0x1F,0x00,0x00,0xE0,0x10,0x3C,0x1F,0xC0,0x00,0x00},/*"W",55*/
{0x10,0x04,0x18,0x0C,0x16,0x34,0x01,0xC0,0x01,0xC0,0x16,0x34,0x18,0x0C,0x10,0x04},/*"X",56*/
{0x10,0x00,0x1C,0x00,0x13,0x04,0x00,0xFC,0x13,0x04,0x1C,0x00,0x10,0x00,0x00,0x00},/*"Y",57*/
{0x08,0x04,0x10,0x1C,0x10,0x64,0x10,0x84,0x13,0x04,0x1C,0x04,0x10,0x18,0x00,0x00},/*"Z",58*/
{0x00,0x00,0x00,0x00,0x00,0x00,0x7F,0xFE,0x40,0x02,0x40,0x02,0x40,0x02,0x00,0x00},/*"[",59*/
{0x00,0x00,0x30,0x00,0x0C,0x00,0x03,0x80,0x00,0x60,0x00,0x1C,0x00,0x03,0x00,0x00},/*"\",60*/
{0x00,0x00,0x40,0x02,0x40,0x02,0x40,0x02,0x7F,0xFE,0x00,0x00,0x00,0x00,0x00,0x00},/*"]",61*/
{0x00,0x00,0x00,0x00,0x20,0x00,0x40,0x00,0x40,0x00,0x40,0x00,0x20,0x00,0x00,0x00},/*"^",62*/
{0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x01},/*"_",63*/
{0x00,0x00,0x40,0x00,0x40,0x00,0x20,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"`",64*/
{0x00,0x00,0x00,0x98,0x01,0x24,0x01,0x44,0x01,0x44,0x01,0x44,0x00,0xFC,0x00,0x04},/*"a",65*/
{0x10,0x00,0x1F,0xFC,0x00,0x88,0x01,0x04,0x01,0x04,0x00,0x88,0x00,0x70,0x00,0x00},/*"b",66*/
{0x00,0x00,0x00,0x70,0x00,0x88,0x01,0x04,0x01,0x04,0x01,0x04,0x00,0x88,0x00,0x00},/*"c",67*/
{0x00,0x00,0x00,0x70,0x00,0x88,0x01,0x04,0x01,0x04,0x11,0x08,0x1F,0xFC,0x00,0x04},/*"d",68*/
{0x00,0x00,0x00,0xF8,0x01,0x44,0x01,0x44,0x01,0x44,0x01,0x44,0x00,0xC8,0x00,0x00},/*"e",69*/
{0x00,0x00,0x01,0x04,0x01,0x04,0x0F,0xFC,0x11,0x04,0x11,0x04,0x11,0x00,0x18,0x00},/*"f",70*/
{0x00,0x00,0x00,0xD6,0x01,0x29,0x01,0x29,0x01,0x29,0x01,0xC9,0x01,0x06,0x00,0x00},/*"g",71*/
{0x10,0x04,0x1F,0xFC,0x00,0x84,0x01,0x00,0x01,0x00,0x01,0x04,0x00,0xFC,0x00,0x04},/*"h",72*/
{0x00,0x00,0x01,0x04,0x19,0x04,0x19,0xFC,0x00,0x04,0x00,0x04,0x00,0x00,0x00,0x00},/*"i",73*/
{0x00,0x00,0x00,0x03,0x00,0x01,0x01,0x01,0x19,0x01,0x19,0xFE,0x00,0x00,0x00,0x00},/*"j",74*/
{0x10,0x04,0x1F,0xFC,0x00,0x24,0x00,0x40,0x01,0xB4,0x01,0x0C,0x01,0x04,0x00,0x00},/*"k",75*/
{0x00,0x00,0x10,0x04,0x10,0x04,0x1F,0xFC,0x00,0x04,0x00,0x04,0x00,0x00,0x00,0x00},/*"l",76*/
{0x01,0x04,0x01,0xFC,0x01,0x04,0x01,0x00,0x01,0xFC,0x01,0x04,0x01,0x00,0x00,0xFC},/*"m",77*/
{0x01,0x04,0x01,0xFC,0x00,0x84,0x01,0x00,0x01,0x00,0x01,0x04,0x00,0xFC,0x00,0x04},/*"n",78*/
{0x00,0x00,0x00,0xF8,0x01,0x04,0x01,0x04,0x01,0x04,0x01,0x04,0x00,0xF8,0x00,0x00},/*"o",79*/
{0x01,0x01,0x01,0xFF,0x00,0x85,0x01,0x04,0x01,0x04,0x00,0x88,0x00,0x70,0x00,0x00},/*"p",80*/
{0x00,0x00,0x00,0x70,0x00,0x88,0x01,0x04,0x01,0x04,0x01,0x05,0x01,0xFF,0x00,0x01},/*"q",81*/
{0x01,0x04,0x01,0x04,0x01,0xFC,0x00,0x84,0x01,0x04,0x01,0x00,0x01,0x80,0x00,0x00},/*"r",82*/
{0x00,0x00,0x00,0xCC,0x01,0x24,0x01,0x24,0x01,0x24,0x01,0x24,0x01,0x98,0x00,0x00},/*"s",83*/
{0x00,0x00,0x01,0x00,0x01,0x00,0x07,0xF8,0x01,0x04,0x01,0x04,0x00,0x00,0x00,0x00},/*"t",84*/
{0x01,0x00,0x01,0xF8,0x00,0x04,0x00,0x04,0x00,0x04,0x01,0x08,0x01,0xFC,0x00,0x04},/*"u",85*/
{0x01,0x00,0x01,0x80,0x01,0x70,0x00,0x0C,0x00,0x10,0x01,0x60,0x01,0x80,0x01,0x00},/*"v",86*/
{0x01,0xF0,0x01,0x0C,0x00,0x30,0x01,0xC0,0x00,0x30,0x01,0x0C,0x01,0xF0,0x01,0x00},/*"w",87*/
{0x00,0x00,0x01,0x04,0x01,0x8C,0x00,0x74,0x01,0x70,0x01,0x8C,0x01,0x04,0x00,0x00},/*"x",88*/
{0x01,0x01,0x01,0x81,0x01,0x71,0x00,0x0E,0x00,0x18,0x01,0x60,0x01,0x80,0x01,0x00},/*"y",89*/
{0x00,0x00,0x01,0x84,0x01,0x0C,0x01,0x34,0x01,0x44,0x01,0x84,0x01,0x0C,0x00,0x00},/*"z",90*/
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x3E,0xFC,0x40,0x02,0x40,0x02},/*"{",91*/
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00},/*"|",92*/
{0x00,0x00,0x40,0x02,0x40,0x02,0x3E,0xFC,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"}",93*/
{0x00,0x00,0x60,0x00,0x80,0x00,0x80,0x00,0x40,0x00,0x40,0x00,0x20,0x00,0x20,0x00},/*"~",94*/
};  


struct chinese hz[]=
{

"³ð",0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x18,0xE0,0x00,0x00,0xF8,0xE0,0x00,0x7F,0xF0,0xE0,0x00,0x7F,0xCC,0xFF,0x00,
0x3F,0x9F,0xFF,0x80,0x19,0x9F,0xFF,0x00,0x01,0x98,0xE6,0x00,0x01,0x80,0xC6,0x00,
0x01,0x80,0xC6,0x00,0x01,0x81,0xCE,0x00,0x01,0x81,0xCE,0x00,0x01,0x83,0x8E,0x00,
0x01,0x83,0x8E,0x00,0x01,0x87,0x0F,0x00,0x01,0x8F,0x0F,0x02,0x01,0xBE,0x07,0xFE,
0x01,0xF8,0x07,0xFE,0x01,0x80,0x03,0xFC,0x01,0x80,0x00,0xF8,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*"Æë",0*/

	
"Ö¾",0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0x00,0x00,
0x00,0x03,0x80,0x00,0x00,0x03,0x80,0x00,0x00,0x03,0x80,0x00,0x07,0xFF,0xFF,0xE0,
0x0F,0xFF,0xFF,0xE0,0x0C,0x03,0x80,0x00,0x00,0x03,0x80,0x00,0x01,0xFF,0xFF,0x80,
0x03,0xFF,0xFF,0x80,0x01,0x00,0x80,0x00,0x00,0x81,0xCC,0x00,0x09,0xE1,0x9E,0x00,
0x19,0xF9,0x1C,0x00,0x18,0x3E,0x38,0x00,0x38,0x07,0xE0,0x00,0x78,0x01,0xF8,0x06,
0x70,0x00,0x7F,0xFE,0x70,0x00,0x1F,0xF8,0x00,0x00,0x07,0xF0,0x00,0x00,0x01,0xC0,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*"Ê¦",0*/
	
"Åô",0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x04,0x00,
0x00,0x00,0x0C,0x00,0x00,0x00,0x0C,0x00,0x0F,0xBE,0x7F,0xE0,0x0F,0xBE,0xFF,0xE0,
0x0D,0xB6,0x60,0xE0,0x0D,0xB6,0x6C,0xC0,0x0F,0xBE,0x6C,0xC0,0x0F,0xBE,0x67,0xC0,
0x0C,0xB6,0x63,0xC0,0x0C,0xB6,0x67,0x80,0x0F,0xBE,0x60,0x18,0x0F,0xB6,0x7F,0xFC,
0x0D,0xB6,0x60,0x1C,0x0D,0xA6,0x40,0x1C,0x19,0xE6,0xFF,0xDC,0x38,0xE7,0xC0,0x18,
0x79,0xC6,0x00,0x38,0xF1,0x86,0x07,0xF8,0x00,0x00,0x03,0xF0,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*"Åô",0*/
	
		
};


static void TFTLCD_GPIO_Config()
{
	GPIO_InitTypeDef GPIO_Initstruct;
	
	/*¿ØÖÆÐÅºÅÒý½Å*/
	RCC_APB2PeriphClockCmd(LCD_CS_CLK|LCD_BK_CLK|LCD_RD_CLK|LCD_WR_CLK|LCD_DC_CLK,ENABLE);
	
	GPIO_Initstruct.GPIO_Mode=GPIO_Mode_AF_PP;
	GPIO_Initstruct.GPIO_Pin=LCD_CS_PIN;
	GPIO_Initstruct.GPIO_Speed=GPIO_Speed_50MHz;
	GPIO_Init(LCD_CS_PORT,&GPIO_Initstruct);
	
	GPIO_Initstruct.GPIO_Pin=LCD_RD_PIN;
	GPIO_Init(LCD_RD_PORT,&GPIO_Initstruct);
	
	GPIO_Initstruct.GPIO_Pin=LCD_WR_PIN;
	GPIO_Init(LCD_WR_PORT,&GPIO_Initstruct);
	
	GPIO_Initstruct.GPIO_Pin=LCD_DC_PIN;
	GPIO_Init(LCD_DC_PORT,&GPIO_Initstruct);
	/*Êý¾ÝÏßÒý½Å*/
	RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOD|RCC_APB2Periph_GPIOE,ENABLE);
	
	GPIO_Initstruct.GPIO_Pin=LCD_D0_PIN;
	GPIO_Init(LCD_D0_PORT,&GPIO_Initstruct);
	
	GPIO_Initstruct.GPIO_Pin=LCD_D1_PIN;
	GPIO_Init(LCD_D1_PORT,&GPIO_Initstruct);
	
	GPIO_Initstruct.GPIO_Pin=LCD_D2_PIN;
	GPIO_Init(LCD_D2_PORT,&GPIO_Initstruct);
	
	GPIO_Initstruct.GPIO_Pin=LCD_D3_PIN;
	GPIO_Init(LCD_D3_PORT,&GPIO_Initstruct);
	
	GPIO_Initstruct.GPIO_Pin=LCD_D4_PIN;
	GPIO_Init(LCD_D4_PORT,&GPIO_Initstruct);
	
	GPIO_Initstruct.GPIO_Pin=LCD_D5_PIN;
	GPIO_Init(LCD_D5_PORT,&GPIO_Initstruct);
	
	GPIO_Initstruct.GPIO_Pin=LCD_D6_PIN;
	GPIO_Init(LCD_D6_PORT,&GPIO_Initstruct);
	
	GPIO_Initstruct.GPIO_Pin=LCD_D7_PIN;
	GPIO_Init(LCD_D7_PORT,&GPIO_Initstruct);
	
	GPIO_Initstruct.GPIO_Pin=LCD_D8_PIN;
	GPIO_Init(LCD_D8_PORT,&GPIO_Initstruct);
	
	GPIO_Initstruct.GPIO_Pin=LCD_D9_PIN;
	GPIO_Init(LCD_D9_PORT,&GPIO_Initstruct);
	
	GPIO_Initstruct.GPIO_Pin=LCD_D10_PIN;
	GPIO_Init(LCD_D10_PORT,&GPIO_Initstruct);
	
	GPIO_Initstruct.GPIO_Pin=LCD_D11_PIN;
	GPIO_Init(LCD_D11_PORT,&GPIO_Initstruct);
	
	GPIO_Initstruct.GPIO_Pin=LCD_D12_PIN;
	GPIO_Init(LCD_D12_PORT,&GPIO_Initstruct);
	
	GPIO_Initstruct.GPIO_Pin=LCD_D13_PIN;
	GPIO_Init(LCD_D13_PORT,&GPIO_Initstruct);
	
	GPIO_Initstruct.GPIO_Pin=LCD_D14_PIN;
	GPIO_Init(LCD_D14_PORT,&GPIO_Initstruct);
	
	GPIO_Initstruct.GPIO_Pin=LCD_D15_PIN;
	GPIO_Init(LCD_D15_PORT,&GPIO_Initstruct);
	
	
	GPIO_Initstruct.GPIO_Pin=LCD_BK_PIN;
	GPIO_Initstruct.GPIO_Mode=GPIO_Mode_Out_PP;
	GPIO_Initstruct.GPIO_Speed=GPIO_Speed_50MHz;
	GPIO_Init(LCD_BK_PORT,&GPIO_Initstruct);
	
	LCD_BK=1;
}

static void TFTLCD_Mode_Config()
{
	FSMC_NORSRAMInitTypeDef FSMC_NORSRAMInitstruct;
	FSMC_NORSRAMTimingInitTypeDef FSMC_ReadTimingstruct;
	FSMC_NORSRAMTimingInitTypeDef FSMC_WriteTimingstruct;
	RCC_AHBPeriphClockCmd(RCC_AHBPeriph_FSMC,ENABLE);
	
	FSMC_ReadTimingstruct.FSMC_AccessMode=FSMC_AccessMode_A;
	FSMC_ReadTimingstruct.FSMC_AddressHoldTime=0x00;
	FSMC_ReadTimingstruct.FSMC_AddressSetupTime=0x01;
	FSMC_ReadTimingstruct.FSMC_BusTurnAroundDuration=0x00;
	FSMC_ReadTimingstruct.FSMC_CLKDivision=0x00;
	FSMC_ReadTimingstruct.FSMC_DataLatency=0x00;
	FSMC_ReadTimingstruct.FSMC_DataSetupTime=0x0f;
	
	FSMC_WriteTimingstruct.FSMC_AccessMode=FSMC_AccessMode_A;
	FSMC_WriteTimingstruct.FSMC_AddressHoldTime=0x15;
	FSMC_WriteTimingstruct.FSMC_AddressSetupTime=0x15;
	FSMC_WriteTimingstruct.FSMC_BusTurnAroundDuration=0x00;
	FSMC_WriteTimingstruct.FSMC_CLKDivision=0x00;
	FSMC_WriteTimingstruct.FSMC_DataLatency=0x00;
	FSMC_WriteTimingstruct.FSMC_DataSetupTime=0x05;
	
	
	FSMC_NORSRAMInitstruct.FSMC_WriteOperation=FSMC_WriteOperation_Enable;
	FSMC_NORSRAMInitstruct.FSMC_Bank=FSMC_Bank1_NORSRAM4;
	FSMC_NORSRAMInitstruct.FSMC_ExtendedMode=FSMC_ExtendedMode_Enable;
	FSMC_NORSRAMInitstruct.FSMC_MemoryDataWidth=FSMC_MemoryDataWidth_16b;
	FSMC_NORSRAMInitstruct.FSMC_MemoryType=FSMC_MemoryType_SRAM;
	
	
	FSMC_NORSRAMInitstruct.FSMC_BurstAccessMode=FSMC_BurstAccessMode_Disable;
	FSMC_NORSRAMInitstruct.FSMC_DataAddressMux=FSMC_DataAddressMux_Disable;
	FSMC_NORSRAMInitstruct.FSMC_WaitSignal=FSMC_WaitSignal_Disable;
	FSMC_NORSRAMInitstruct.FSMC_WaitSignalActive=FSMC_WaitSignalActive_BeforeWaitState;
	FSMC_NORSRAMInitstruct.FSMC_WaitSignalPolarity=FSMC_WaitSignalPolarity_Low;
	FSMC_NORSRAMInitstruct.FSMC_WrapMode=FSMC_WrapMode_Disable;
	FSMC_NORSRAMInitstruct.FSMC_WriteBurst=FSMC_WriteBurst_Disable;
	FSMC_NORSRAMInitstruct.FSMC_AsynchronousWait=FSMC_AsynchronousWait_Disable;
	
	
	FSMC_NORSRAMInitstruct.FSMC_WriteTimingStruct=&FSMC_WriteTimingstruct;
	FSMC_NORSRAMInitstruct.FSMC_ReadWriteTimingStruct=&FSMC_ReadTimingstruct;
	
	FSMC_NORSRAMInit(&FSMC_NORSRAMInitstruct);
	FSMC_NORSRAMCmd(FSMC_Bank1_NORSRAM4,ENABLE);
}


void LCD_WriteCmd(u16 cmd)
{
	W_CMD=cmd;
}

void LCD_WriteData(u16 data)
{
	W_DATA=data;
}

void TFTLCD_Init()
{
	u16 tmp=0;
	TFTLCD_GPIO_Config();
	TFTLCD_Mode_Config();
	
	
	
	delay_ms(20);
	LCD_WriteCmd(0xda);
	tmp=W_DATA;
	tmp=W_DATA<<8;
	LCD_WriteCmd(0xdb);
	tmp|=W_DATA;
	tmp|=W_DATA;
	printf("LCD ID:0x%x\r\n",tmp);
	
	LCD_WriteCmd(0xE0); //P-Gamma
	LCD_WriteData(0x00);
	LCD_WriteData(0x13);
	LCD_WriteData(0x18);
	LCD_WriteData(0x04);
	LCD_WriteData(0x0F);
	LCD_WriteData(0x06);
	LCD_WriteData(0x3A);
	LCD_WriteData(0x56);
	LCD_WriteData(0x4D);
	LCD_WriteData(0x03);
	LCD_WriteData(0x0A);
	LCD_WriteData(0x06);
	LCD_WriteData(0x30);
	LCD_WriteData(0x3E);
	LCD_WriteData(0x0F);
	
	LCD_WriteCmd(0XE1); //N-Gamma
	LCD_WriteData(0x00);
	LCD_WriteData(0x13);
	LCD_WriteData(0x18);
	LCD_WriteData(0x01);
	LCD_WriteData(0x11);
	LCD_WriteData(0x06);
	LCD_WriteData(0x38);
	LCD_WriteData(0x34);
	LCD_WriteData(0x4D);
	LCD_WriteData(0x06);
	LCD_WriteData(0x0D);
	LCD_WriteData(0x0B);
	LCD_WriteData(0x31);
	LCD_WriteData(0x37);
	LCD_WriteData(0x0F); 
	
	LCD_WriteCmd(0XC0);   //Power Control 1
	LCD_WriteData(0x18); //Vreg1out
	LCD_WriteData(0x17); //Verg2out
	
	LCD_WriteCmd(0xC1);   //Power Control 2
	LCD_WriteData(0x41); //VGH,VGL
	
	LCD_WriteCmd(0xC5);   //Power Control 3
	LCD_WriteData(0x00);
	LCD_WriteData(0x1A); //Vcom
	LCD_WriteData(0x80);
	
	LCD_WriteCmd(0x36);   //Memory Access
	LCD_WriteData(0x08);   //48
	
	LCD_WriteCmd(0x3A);   // Interface Pixel Format
	LCD_WriteData(0x55); //16bit
	
	LCD_WriteCmd(0XB0);   // Interface Mode Control
	LCD_WriteData(0x00);
	
	LCD_WriteCmd(0xB1);   //Frame rate
	LCD_WriteData(0xA0); //60Hz
	
	LCD_WriteCmd(0xB4);   //Display Inversion Control
	LCD_WriteData(0x02); //2-dot
	
	LCD_WriteCmd(0XB6);   //RGB/MCU Interface Control
//	LCD_WriteData(0x02); //MCU RGB
//	LCD_WriteData(0x02); //Source,Gate scan dieection
	LCD_WriteData(0x00);
	LCD_WriteData(0x22);//0 GS SS SM ISC[3:0];ÆäÖÐGS SS¿ØÖÆÏÔÊ¾·½Ïò£¬Í¬Ê±ÐÞ¸ÄR36
	LCD_WriteData(0x3B);
	
	LCD_WriteCmd(0XE9);    // Set Image Function
	LCD_WriteData(0x00);  //disable 24 bit data input
	
	LCD_WriteCmd(0xF7);    // Adjust Control
	LCD_WriteData(0xA9);
	LCD_WriteData(0x51);
	LCD_WriteData(0x2C);
	LCD_WriteData(0x82);  // D7 stream, loose
	
	LCD_WriteCmd(0x11);    //Sleep out
	delay_ms(120);
	LCD_WriteCmd(0x29);  
	LCD_WriteCmd(0x2C);
	
	TFTLCD_Set_dir(0);
	
	FULL_COloc(0xffff);
}

//0:ÊúÆÁ  1:ºáÆÁ
void TFTLCD_Set_dir(u8 dir)
{
	if(dir)
	{
		LCD_WriteCmd(0x36);
		LCD_WriteData(0x28);
		LCD_WriteCmd(0xb6);
		LCD_WriteData(0x00);
		LCD_WriteData(0x02);
		LCD_WriteData(0x3b);
	}
	else
	{
		LCD_WriteCmd(0x36);
		LCD_WriteData(0x08);
	}
}

void FULL_COloc(u16 color)
{
	int tt=320*480;
	LCD_WriteCmd(0x2a);
	LCD_WriteData(0x00);
	LCD_WriteData(0x00);
	LCD_WriteData(0x01);
	LCD_WriteData(0x3f);
	
	LCD_WriteCmd(0x2b);
	LCD_WriteData(0x00);
	LCD_WriteData(0x00);
	LCD_WriteData(0x01);
	LCD_WriteData(0xdf);
	
	LCD_WriteCmd(0x2c);
	
	while(tt--)
	{
		LCD_WriteData((color>>8)&0xff);
		LCD_WriteData(color&0xff);
	}
	
}
//½¨Á¢´°¿Ú
void TFTLCD_Set_Window(u16 x,u16 y,u16 width,u16 heigh)
{
	LCD_WriteCmd(0x2a);
	LCD_WriteData(x/256);
	LCD_WriteData(x%256);
	LCD_WriteData((width)/256);
	LCD_WriteData((width)%256);
	
	LCD_WriteCmd(0x2b);
	LCD_WriteData(y/256);
	LCD_WriteData(y%256);
	LCD_WriteData((heigh)/256);
	LCD_WriteData((heigh)%256);
	LCD_WriteCmd(0x2c);
}
//»­¾ØÐÎ
void TFTLCD_Rectangle(u16 x,u16 y,u16 width,u16 heigh,u16 color)
{
	u16 i=0;
	u16 area=(x+width)*(y+heigh);
	TFTLCD_Set_Window(x,y,x+width,y+heigh);
	for(i=0;i<area;i++)
	{
		LCD_WriteData((color>>8)&0xff);
		LCD_WriteData(color&0xff);
		delay_ms(50);
	}
}
//Ãèµã
void TFTLCD_Dot(u16 x,u16 y,u16 color)
{
	TFTLCD_Set_Window(x,y,x,y);
	LCD_WriteData((color>>8)&0xff);
	LCD_WriteData(color&0xff);
}

void LCD_Write_color(u16 color)
{
	LCD_WriteData((color>>8)&0xff);
	LCD_WriteData(color&0xff);
}

//»­Ïß
void TFTLCD_Line(u16 col,u16 row,u16 len,u16 color)
{
	u16 i=0;
	if((col+len)>320&&(row>480))
	{
		return;
	}
	for(i=col;i<(col+len);i++)
	{
		TFTLCD_Dot(i,row,color);
	}
}


//»­Ð±ÏßÖ±Ïß
void TFTLCD_Draw_Line(u16 x1,u16 y1,u16 x2,u16 y2,u16 color)
{
	u16 i=0;
	int delat_x=0,delat_y=0,xerr=0,yerr=0;
	int urow=x1,ucol=y1;
	int distance=0;
	int incx=0,incy=0;
	delat_x=x2-x1;
	delat_y=y2-y1;
	if(delat_x>0)
		incx=1;
	else if(delat_x==0)
		incx=0;
	else
		incx=-1;
	
	if(delat_y>0)
		incy=1;
	else if(delat_y==0)
		incy=0;
	else
		incy=-1;
	if(delat_x>delat_y)
		distance=delat_x;
	else
		distance=delat_y;
	for(i=0;i<=distance+1;i++)
	{
		TFTLCD_Dot(urow,ucol,color);
		xerr+=delat_x;
		yerr+=delat_y;
		if(xerr>distance)
		{
			xerr-=distance;
			urow+=incx;
		}
		if(yerr>distance)
		{
			yerr-=distance;
			ucol+=incy;
		}
	}
	
}

//»­Ô°
void LCD_Draw_Circle(u16 x0,u16 y0,u8 r)
{
	int a,b;
	int di;
	a=0;b=r;	  
	di=3-(r<<1);             //ÅÐ¶ÏÏÂ¸öµãÎ»ÖÃµÄ±êÖ¾
	while(a<=b)
	{
		TFTLCD_Dot(x0+a,y0-b,BLACK);             //5
 		TFTLCD_Dot(x0+b,y0-a,BLACK);             //0           
		TFTLCD_Dot(x0+b,y0+a,BLACK);             //4               
		TFTLCD_Dot(x0+a,y0+b,BLACK);             //6 
		TFTLCD_Dot(x0-a,y0+b,BLACK);             //1       
 		TFTLCD_Dot(x0-b,y0+a,BLACK);             
		TFTLCD_Dot(x0-a,y0-b,BLACK);             //2             
  		TFTLCD_Dot(x0-b,y0-a,BLACK);             //7     	         
		a++;
		//Ê¹ÓÃBresenhamËã·¨»­Ô²     
		if(di<0)di +=4*a+6;	  
		else
		{
			di+=10+4*(a-b);   
			b--;
		}
		delay_ms(20);
	}
} 

void TFTLCD_Show_Char(u16 x,u16 y,u8 ch,u8 size,u8 mode)
{
	u8 tmp=0;
	u8 i=0;
	u8 j=0;
	u16 y0=y;
	u8 csize=(size/8+((size%8)?1:0))*(size/2);
	ch=ch-' ';
	for(i=0;i<csize;i++)
	{
		tmp=ascii_1608[ch][i];
		for(j=0;j<8;j++)
		{
			if(tmp&0x80)
			{
				TFTLCD_Dot(x,y,BLACK);
			}
			else if(mode==0)
			{
				TFTLCD_Dot(x,y,WHITE);
			}
			tmp<<=1;
			y++;
			if(y>=480)
			{
				return;
			}
			if((y-y0)==size)
			{
				y=y0;
				x++;
				if(x>=320)
				{
					return;
				}
				break;
			}
		}
	}
}

void TFTLCD_Show_String(u16 x,u16 y,u8* str,u8 size)
{
	u16 x0=x;
	while(*str!='\0')
	{
		TFTLCD_Show_Char(x,y,*str,size,0);
		str++;
		x+=size/2;
		if(x>=320)
		{
			x=x0;
			y+=size;
		}
		if(y>=480)
		{
			break;
		}
	}
}



void TFTLCD_Show_HZ(u16 x,u16 y,u8* cn)
{
	u16 row=0;
	u16 byte=0;
	u16 x0=x;
	u16 y0=y;
	u8 bit=0;
	u8 data=0;
	u8 wordnum=0;
	while(*cn!='\0')
	{
		if((hz[wordnum].hz[0]==*cn)&&(hz[wordnum].hz[1]==*(cn+1)))
		{
			for(row=0;row<32;row++)
			{
				for(byte=0;byte<4;byte++)
				{
					data=hz[wordnum].data[row*4+byte];
					for(bit=0;bit<8;bit++)
					{
						if(data&(0x80>>bit))
						{
							TFTLCD_Dot(x,y,BLACK);
						}
						else
						{
							TFTLCD_Dot(x,y,WHITE);
						}
						x++;
						if((x-x0)==32)
						{
							x=x0;
							y++;
							if((y-y0)==32)
							{
								y=y0;
							}
						}
					}
				}
			}
		}
		x+=32;
		x0=x;
		wordnum++;
		cn+=2;
	}
}

u16 TFTLCD_Pow(u16 x,u16 y)
{
	u16 tmp=1;
	while(y--)
	{
		tmp*=x;
	}
	return tmp;
}

void TFTLCD_Show_NUM(u16 x,u16 y,u16 num,u8 len)
{
	u8 i=0;
	for(i=0;i<len;i++)
	{
		TFTLCD_Show_Char(x,y,(num/TFTLCD_Pow(10,len-1-i)%10)+'0',16,0);
		x+=8;
	}
}

void TFTLCD_Show_HEX(u16 x,u16 y,u16 num,u8 len)
{
	u8 i=0;
	u16 tmp=0;
	for(i=0;i<len;i++)
	{
		tmp=(num/TFTLCD_Pow(16,len-1-i)%16);
		printf("HEX:%d\r\n",tmp);
		if(tmp>9)
		{
			tmp+='7';
		}
		else
		{
			tmp+='0';
		}
		TFTLCD_Show_Char(x,y,tmp,16,0);
		x+=8;
	}
}

void TFTLCD_Fill_dot(u16 xsta,u16 ysta,u16 xend,u16 yend,u16 color)
{
	if((xsta>xend)||(ysta>yend))
	{
		return;
	}
	TFTLCD_Set_Window(xsta,ysta,xend,yend);
	u16 xtmp=xend-xsta+1;
	u16 ytmp=yend-ysta+1;
	while(xtmp--)
	{
		while(ytmp--)
		{
			LCD_Write_color(color);
		}
	}
}